class AIHandler {
    constructor() {
        this.responses = {
            greeting: [
                '‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏±‡∏ö üòä',
                '‡∏´‡∏ß‡∏±‡∏î‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏´‡∏°? üëã',
                '‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏´‡∏°? üåü'
            ],
            help: [
                '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏∞‡πÑ‡∏£‡∏Ñ‡∏£‡∏±‡∏ö? ü§ù',
                '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ö‡∏≠‡∏Å‡∏ú‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ üí™',
                '‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏ö‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‚ú®'
            ],
            thanks: [
                '‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö üôè',
                '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏±‡∏ö ‚ò∫Ô∏è',
                '‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏£‡∏Ñ‡∏£‡∏±‡∏ö ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠ üíñ'
            ],
            bye: [
                '‡∏•‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ üëã',
                '‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏´‡∏ß‡∏±‡∏á‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏û‡∏ö‡∏Å‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà üåà',
                '‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏ö‡∏Å‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö ‚ú®'
            ],
            weather: [
                '‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö ‚òÄÔ∏è',
                '‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏µ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö üå§Ô∏è',
                '‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö üå∫'
            ],
            time: [
                `‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ${new Date().toLocaleTimeString('th-TH')} ‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤‡∏Ñ‡∏£‡∏±‡∏ö ‚è∞`,
                `‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ß‡∏•‡∏≤ ${new Date().toLocaleTimeString('th-TH')} ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö üïê`
            ],
            joke: [
                '‡∏ó‡∏≥‡πÑ‡∏°‡πÑ‡∏Å‡πà‡∏Ç‡πâ‡∏≤‡∏°‡∏ñ‡∏ô‡∏ô? ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏õ‡∏≠‡∏µ‡∏Å‡∏ù‡∏±‡πà‡∏á‡πÑ‡∏á‡∏Ñ‡∏£‡∏±‡∏ö üòÑ',
                '‡∏£‡∏π‡πâ‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ó‡∏≥‡πÑ‡∏°‡∏õ‡∏•‡∏≤‡πÑ‡∏°‡πà‡∏ä‡∏≠‡∏ö‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏ü‡∏ã‡∏ö‡∏∏‡πä‡∏Å? ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Å‡∏•‡∏±‡∏ß‡∏ï‡∏¥‡∏î‡πÅ‡∏´‡∏á‡πá‡∏Å üòÜ',
                '‡∏ß‡∏±‡∏ô‡πÜ ‡∏ô‡∏±‡πà‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏ï‡πà‡∏Ñ‡∏≠‡∏° ‡∏û‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏Å‡πá‡∏Ñ‡∏≠‡∏°‡∏û‡∏±‡∏Å üòÖ'
            ],
            food: [
                '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏ó‡∏¢‡∏≠‡∏£‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö üçú',
                '‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡πâ‡∏°‡∏ï‡∏≥‡πÑ‡∏ó‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡πÄ‡∏ú‡πá‡∏î‡πÜ ‡∏£‡πâ‡∏≠‡∏ô‡πÜ üå∂Ô∏è',
                '‡∏ú‡∏°‡∏ä‡∏≠‡∏ö‡∏ú‡∏±‡∏î‡πÑ‡∏ó‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏Ñ‡∏∏‡∏ì‡∏•‡πà‡∏∞‡∏ä‡∏≠‡∏ö‡∏≠‡∏∞‡πÑ‡∏£? ü•ò'
            ],
            music: [
                '‡πÄ‡∏û‡∏•‡∏á‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö üéµ',
                '‡∏î‡∏ô‡∏ï‡∏£‡∏µ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö üéº',
                '‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏á‡∏ü‡∏±‡∏á‡∏™‡∏ö‡∏≤‡∏¢‡πÜ ‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö üéπ'
            ],
            default: [
                '‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ü§î',
                '‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ä‡πà‡∏ß‡∏¢‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö? üôè',
                '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö? üí≠'
            ]
        };

        this.keywords = {
            greeting: ['‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ', '‡∏´‡∏ß‡∏±‡∏î‡∏î‡∏µ', '‡∏ó‡∏±‡∏Å‡∏ó‡∏≤‡∏¢', 'hi', 'hello', '‡∏î‡∏µ'],
            help: ['‡∏ä‡πà‡∏ß‡∏¢', '‡∏Ç‡∏≠', '‡∏≠‡∏¢‡∏≤‡∏Å', '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£', 'help', '‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏ô‡πà‡∏≠‡∏¢'],
            thanks: ['‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì', 'thank', '‡∏Ç‡∏≠‡∏ö‡πÉ‡∏à', '‡∏ö‡∏Ñ‡∏∏‡∏ì', '‡∏Ç‡∏≠‡∏ö'],
            bye: ['‡∏•‡∏≤‡∏Å‡πà‡∏≠‡∏ô', '‡∏ö‡∏≤‡∏¢', 'bye', '‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô', '‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô'],
            weather: ['‡∏≠‡∏≤‡∏Å‡∏≤‡∏®', '‡∏ù‡∏ô', '‡∏£‡πâ‡∏≠‡∏ô', '‡∏´‡∏ô‡∏≤‡∏ß', 'weather', '‡∏ù‡∏ô‡∏ï‡∏Å'],
            time: ['‡∏Å‡∏µ‡πà‡πÇ‡∏°‡∏á', '‡πÄ‡∏ß‡∏•‡∏≤', 'time', '‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤'],
            joke: ['‡∏ï‡∏•‡∏Å', '‡∏Ç‡∏≥', 'joke', '‡∏°‡∏∏‡∏Å', '‡πÄ‡∏•‡πà‡∏ô‡∏°‡∏∏‡∏Å'],
            food: ['‡∏≠‡∏≤‡∏´‡∏≤‡∏£', '‡∏Å‡∏¥‡∏ô', '‡∏´‡∏¥‡∏ß', '‡∏Ç‡πâ‡∏≤‡∏ß', 'food', '‡∏≠‡∏£‡πà‡∏≠‡∏¢'],
            music: ['‡πÄ‡∏û‡∏•‡∏á', '‡∏î‡∏ô‡∏ï‡∏£‡∏µ', 'music', '‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏•‡∏á', '‡∏ü‡∏±‡∏á‡πÄ‡∏û‡∏•‡∏á']
        };
    }

    findIntent(message) {
        message = message.toLowerCase();
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ intent
        for (const [intent, keywords] of Object.entries(this.keywords)) {
            if (keywords.some(keyword => message.includes(keyword))) {
                return intent;
            }
        }

        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°
        if (message.includes('?') || message.includes('‡πÑ‡∏´‡∏°') || message.includes('‡∏°‡∏±‡πâ‡∏¢')) {
            return 'help';
        }

        return 'default';
    }

    getResponse(message) {
        const intent = this.findIntent(message);
        const possibleResponses = this.responses[intent];
        return possibleResponses[Math.floor(Math.random() * possibleResponses.length)];
    }

    processMessage(message) {
        // ‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡πâ‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ
        if (message.length < 2) {
            return '‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏¢‡∏≤‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üôè';
        }

        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏•‡πâ‡∏ß‡∏ô‡πÜ
        if (/^\d+$/.test(message)) {
            return `‡∏ô‡∏±‡πà‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç ${message} ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö? üî¢`;
        }

        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö AI
        if (message.toLowerCase().includes('ai') || message.toLowerCase().includes('bot')) {
            return '‡∏ú‡∏°‡πÄ‡∏õ‡πá‡∏ô AI Chat Bot ‡∏ó‡∏µ‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏±‡∏ö ü§ñ';
        }

        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏î‡πà‡∏≤
        if (this.containsBadWords(message)) {
            return '‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏∏‡∏†‡∏≤‡∏û‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üôè';
        }

        // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏õ‡∏Å‡∏ï‡∏¥
        return this.getResponse(message);
    }

    containsBadWords(message) {
        const badWords = ['‡πÄ‡∏´‡∏µ‡πâ‡∏¢', '‡∏Ñ‡∏ß‡∏¢', '‡∏™‡∏±‡∏™', '‡πÑ‡∏≠‡πâ', '‡∏°‡∏∂‡∏á', '‡∏Å‡∏π', '‡πÄ‡∏¢‡πá‡∏î'];
        return badWords.some(word => message.toLowerCase().includes(word));
    }
}

module.exports = AIHandler; 